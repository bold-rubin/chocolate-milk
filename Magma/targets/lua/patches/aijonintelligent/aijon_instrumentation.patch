diff --git a/ldebug.c b/ldebug.c
index dcd5b15b..02094006 100644
--- a/ldebug.c
+++ b/ldebug.c
@@ -188,11 +188,13 @@ static const char *upvalname (const Proto *p, int uv) {
 static const char *findvararg (CallInfo *ci, int n, StkId *pos) {
   if (clLvalue(s2v(ci->func))->p->is_vararg) {
     int nextra = ci->u.l.nextraargs;
+IJON_MAX((unsigned long long)nextra); /* PATCHID:9178 */
 #ifdef MAGMA_ENABLE_FIXES
     if (n >= -nextra) {  /* 'n' is negative */
       *pos = ci->func - nextra - (n + 1);
 #else
     if (n <= nextra) {
+IJON_CTX(413); /* PATCHID:8275 */
 #ifdef MAGMA_ENABLE_CANARIES
       MAGMA_LOG("LUA001", INT_MAX - nextra <= (n - 1));
 #endif
@@ -846,12 +848,15 @@ static int changedline (const Proto *p, int oldpc, int newpc) {
 #else
 #ifdef MAGMA_ENABLE_CANARIES
   MAGMA_LOG("LUA002", p->lineinfo == NULL);
+IJON_CMP((unsigned long long)p->lineinfo, 0); /* PATCHID:4647 */
 #endif
 #endif
   if (newpc - oldpc < MAXIWTHABS / 2) {  /* not too far apart? */
+IJON_DIST((long long)(newpc - oldpc), (long long)(MAXIWTHABS / 2 - 1)); /* PATCHID:3625 */
     int delta = 0;  /* line diference */
     int pc = oldpc;
     for (;;) {
+IJON_INC(pc); /* PATCHID:3165 */
       int lineinfo = p->lineinfo[++pc];
       if (lineinfo == ABSLINEINFO)
         break;  /* cannot compute delta; fall through */
@@ -905,11 +910,14 @@ int luaG_traceexec (lua_State *L, const Instruction *pc) {
   if (counthook)
     luaD_hook(L, LUA_HOOKCOUNT, -1, 0, 0);  /* call count hook */
   if (mask & LUA_MASKLINE) {
+IJON_SET((int)(mask & LUA_MASKLINE)); /* PATCHID:2596 */
 #ifdef MAGMA_ENABLE_FIXES
     /* 'L->oldpc' may be invalid; use zero in this case */
     int oldpc = (L->oldpc < p->sizecode) ? L->oldpc : 0;
 #else
     const Proto *p = ci_func(ci)->p;
+IJON_MAX((unsigned long long)L->oldpc); /* PATCHID:1672 */
+IJON_CMP((unsigned long long)L->oldpc, (unsigned long long)p->sizecode); /* PATCHID:1198 */
 #endif
     int npci = pcRel(pc, p);
 #ifdef MAGMA_ENABLE_FIXES
@@ -918,6 +926,7 @@ int luaG_traceexec (lua_State *L, const Instruction *pc) {
 #else
 #ifdef MAGMA_ENABLE_CANARIES
     MAGMA_LOG("LUA004", pcRel(L->oldpc, p) < 0);
+IJON_CTX(345); /* PATCHID:451 */
 #endif
     if (npci == 0 ||
         pc <= L->oldpc ||
diff --git a/liolib.c b/liolib.c
index aa3d5149..4687c14a 100644
--- a/liolib.c
+++ b/liolib.c
@@ -290,6 +290,10 @@ static int io_pclose (lua_State *L) {
 static int io_popen (lua_State *L) {
   const char *filename = luaL_checkstring(L, 1);
   const char *mode = luaL_optstring(L, 2, "r");
+IJON_STRDIST(mode, "z"); /* PATCHID:7269 */
+IJON_STRDIST(mode, "rw"); /* PATCHID:6342 */
+IJON_STRDIST(mode, "x"); /* PATCHID:5736 */
+IJON_SET((int)mode[0]); /* PATCHID:5657 */
   LStream *p = newprefile(L);
 #ifdef MAGMA_ENABLE_FIXES
   luaL_argcheck(L, l_checkmodep(mode), 2, "invalid mode");
