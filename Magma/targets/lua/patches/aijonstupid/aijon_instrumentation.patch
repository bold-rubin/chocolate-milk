diff --git a/ldebug.c b/ldebug.c
index dcd5b15b..6c8abf4c 100644
--- a/ldebug.c
+++ b/ldebug.c
@@ -188,14 +188,19 @@ static const char *upvalname (const Proto *p, int uv) {
 static const char *findvararg (CallInfo *ci, int n, StkId *pos) {
   if (clLvalue(s2v(ci->func))->p->is_vararg) {
     int nextra = ci->u.l.nextraargs;
+IJON_SET((int) nextra); /* PATCHID:9912 */
 #ifdef MAGMA_ENABLE_FIXES
     if (n >= -nextra) {  /* 'n' is negative */
       *pos = ci->func - nextra - (n + 1);
 #else
     if (n <= nextra) {
+IJON_SET((int) n); /* PATCHID:9322 */
 #ifdef MAGMA_ENABLE_CANARIES
       MAGMA_LOG("LUA001", INT_MAX - nextra <= (n - 1));
 #endif
+IJON_MAX((unsigned long long) (nextra + (n - 1))); /* PATCHID:9150 */
+IJON_DIST((long long) (nextra + (n - 1)), (long long) INT_MAX); /* PATCHID:8895 */
+IJON_CMP((unsigned long long) (nextra + (n - 1)), (unsigned long long) INT_MAX); /* PATCHID:8499 */
       *pos = ci->func - nextra + (n - 1);
 #endif
       return "(vararg)";  /* generic name for any vararg */
@@ -849,20 +854,26 @@ static int changedline (const Proto *p, int oldpc, int newpc) {
 #endif
 #endif
   if (newpc - oldpc < MAXIWTHABS / 2) {  /* not too far apart? */
+IJON_DIST((long long)(newpc - oldpc), (long long)(MAXIWTHABS / 2)); /* PATCHID:4662 */
     int delta = 0;  /* line diference */
     int pc = oldpc;
     for (;;) {
       int lineinfo = p->lineinfo[++pc];
+IJON_MAX((unsigned long long)pc); /* PATCHID:4080 */
+IJON_INC(pc); /* PATCHID:3385 */
       if (lineinfo == ABSLINEINFO)
         break;  /* cannot compute delta; fall through */
       delta += lineinfo;
+IJON_SET(delta); /* PATCHID:2853 */
       if (pc == newpc)
         return (delta != 0);  /* delta computed successfully */
+IJON_SET((int)(delta != 0)); /* PATCHID:2364 */
     }
   }
   /* either instructions are too far apart or there is an absolute line
      info in the way; compute line difference explicitly */
   return (luaG_getfuncline(p, oldpc) != luaG_getfuncline(p, newpc));
+IJON_SET(0); /* PATCHID:1621 */
 }
 
 
@@ -883,6 +894,7 @@ int luaG_traceexec (lua_State *L, const Instruction *pc) {
   lu_byte mask = L->hookmask;
 #ifdef MAGMA_ENABLE_FIXES
   const Proto *p = ci_func(ci)->p;
+IJON_DIST((long long)L->oldpc, (long long)p->sizecode); /* PATCHID:944 */
 #endif
   int counthook;
   if (!(mask & (LUA_MASKLINE | LUA_MASKCOUNT))) {  /* no hooks? */
@@ -892,6 +904,7 @@ int luaG_traceexec (lua_State *L, const Instruction *pc) {
   pc++;  /* reference is always next instruction */
   ci->u.l.savedpc = pc;  /* save 'pc' */
   counthook = (--L->hookcount == 0 && (mask & LUA_MASKCOUNT));
+IJON_SET((int)L->hookcount); /* PATCHID:499 */
   if (counthook)
     resethookcount(L);  /* reset count */
   else if (!(mask & LUA_MASKLINE))
@@ -908,10 +921,12 @@ int luaG_traceexec (lua_State *L, const Instruction *pc) {
 #ifdef MAGMA_ENABLE_FIXES
     /* 'L->oldpc' may be invalid; use zero in this case */
     int oldpc = (L->oldpc < p->sizecode) ? L->oldpc : 0;
+IJON_SET((int)oldpc); /* PATCHID:423 */
 #else
     const Proto *p = ci_func(ci)->p;
 #endif
     int npci = pcRel(pc, p);
+IJON_SET((int)npci); /* PATCHID:266 */
 #ifdef MAGMA_ENABLE_FIXES
     if (npci <= oldpc ||  /* call hook when jump back (loop), */
         changedline(p, oldpc, npci)) {  /* or when enter new line */
diff --git a/liolib.c b/liolib.c
index aa3d5149..cb9671ec 100644
--- a/liolib.c
+++ b/liolib.c
@@ -290,6 +290,10 @@ static int io_pclose (lua_State *L) {
 static int io_popen (lua_State *L) {
   const char *filename = luaL_checkstring(L, 1);
   const char *mode = luaL_optstring(L, 2, "r");
+IJON_STRDIST(mode, "wb"); /* PATCHID:7593 */
+IJON_STRDIST(mode, "r+"); /* PATCHID:7424 */
+IJON_STRDIST(mode, "w"); /* PATCHID:7085 */
+IJON_SET((int)mode[0]); /* PATCHID:6288 */
   LStream *p = newprefile(L);
 #ifdef MAGMA_ENABLE_FIXES
   luaL_argcheck(L, l_checkmodep(mode), 2, "invalid mode");
@@ -298,7 +302,9 @@ static int io_popen (lua_State *L) {
   MAGMA_LOG("LUA003", !l_checkmodep(mode));
 #endif
 #endif
+IJON_INC((int)mode[0]); /* PATCHID:5460 */
   p->f = l_popen(L, filename, mode);
+IJON_SET((int)(p->f != NULL)); /* PATCHID:5380 */
   p->closef = &io_pclose;
   return (p->f == NULL) ? luaL_fileresult(L, 0, filename) : 1;
 }
